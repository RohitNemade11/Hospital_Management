create table contries (contry_id char(2) primary key,contry_name varchar(40),region_id int(5),foreign key (region_id) references region(region_id));

create table employees (employee_id int primary key,first_name varchar(20),last_name varchar(20),email varchar(25),phone_num varchar(20),hire_date date,job_id varchar(10),salary int,commision_pct int,manager_id int,dept_id int,foreign key (job_id) references jobs(job_id),foreign key (dept_id) references department(dept_id));

create table job_history (employee_id int,start_date date,end_date date,job_id varchar(10),dept_id int,primary key (employee_id, start_date),foreign key (employee_id) references employees(employee_id),foreign key (job_id) references jobs(job_id),foreign key (dept_id) references department(dept_id));


-- Q1: Find employees whose salary is greater than the average salary
select first_name,last_name,salary from employees where salary > (select avg(salary) from employees);

-- Q2: Find employees whose salary is equal to the minimum salary for their job grade
select e.first_name,e.last_name,e.salary from employees e join job_grade jg on salary between jg.lowest_sal and jg.highest_sal where e.salary = jg.lowest_sal;

-- Q3: Find employees who earn more than the average salary and work in IT departments
select e.first_name,e.last_name,e.salary from employees e join department d on e.dept_id = d.dept_id where e.salary > (select avg(salary) from employees) and d.dept_name like '%IT%';

-- Q4: Find employees who earn more than Mr. Bell
select e1.first_name,e1.last_name,e1.salary from employees e1 where e1.salary > (select e2.salary from employees e2 where e2.first_name = 'Bell');





------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
mysql> create table region(region_id int(2) primary key,region_name varchar(25));
Query OK, 0 rows affected, 1 warning (0.04 sec)

mysql> create countries(country_id char(2) primary key,country_name varchar(40),region_id int(2),foreign key (region_id) references region(region_id));
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'countries(country_id char(2) primary key,country_name varchar(40),region_id int(' at line 1
mysql>
mysql>
mysql> create table countries(country_id char(2) primary key,country_name varchar(40),region_id int(2),foreign key (region_id) references region(region_id));
Query OK, 0 rows affected, 1 warning (0.12 sec)

mysql> create table location(location_id int primary key,street_address varchar(25),postal_code varchar(12),city varchar(30),state_province varchar(12),country_id char(2),foreign key (country_id) references countries(country_id)
);
Query OK, 0 rows affected (0.06 sec)

mysql> create table department(dept_id int primary key,dept_name varchar(30)
,manager_id int,location_id int,foreign key (location_id) references location(location_id));
Query OK, 0 rows affected (0.06 sec)

mysql> create teble jobs(job_id varchar(10) primary key,job_title varchar(35),min_salary int,max_salary int);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'teble jobs(job_id varchar(10) primary key,job_title varchar(35),min_salary int,m' at line 1
mysql> create table jobs(job_id varchar(10) primary key,job_title varchar(35
),min_salary int,max_salary int);
Query OK, 0 rows affected (0.04 sec)

mysql> create table employees (employee_id int primary key,first_name varchar(20),last_name varchar(20),email varchar(25),phone_num varchar(20),hire_date date,job_id varchar(10),salary int,commision_pct int,manager_id int,dept_id int,foreign key (job_id) references jobs(job_id),foreign key (dept_id) references department(dept_id));
Query OK, 0 rows affected (0.08 sec)

mysql> create table job_history (employee_id int primary key,start_date date primary key,end_date date,job_id varchar(10),dept_id int,foreign key (employee_id) references employees(employee_id),foreign key (job_id) references jobs(job_id),foreign key (dept_id) references department(dept_id));
ERROR 1068 (42000): Multiple primary key defined
mysql> create table job_history (employee_id int,start_date date,end_date date,job_id varchar(10),dept_id int,primary key (employee_id, start_date),foreign key (employee_id) references employees(employee_id),foreign key (job_id) references jobs(job_id),foreign key (dept_id) references department(dept_id));
Query OK, 0 rows affected (0.10 sec)

mysql> create table job_grade(grade_level varchar(2) primary key,lowest_sal
int,highest_sal int);
Query OK, 0 rows affected (0.02 sec)

mysql> desc region;
+-------------+-------------+------+-----+---------+-------+
| Field       | Type        | Null | Key | Default | Extra |
+-------------+-------------+------+-----+---------+-------+
| region_id   | int         | NO   | PRI | NULL    |       |
| region_name | varchar(25) | YES  |     | NULL    |       |
+-------------+-------------+------+-----+---------+-------+
2 rows in set (0.09 sec)

mysql> desc countries;
+--------------+-------------+------+-----+---------+-------+
| Field        | Type        | Null | Key | Default | Extra |
+--------------+-------------+------+-----+---------+-------+
| country_id   | char(2)     | NO   | PRI | NULL    |       |
| country_name | varchar(40) | YES  |     | NULL    |       |
| region_id    | int         | YES  | MUL | NULL    |       |
+--------------+-------------+------+-----+---------+-------+
3 rows in set (0.01 sec)

mysql> desc location;
+----------------+-------------+------+-----+---------+-------+
| Field          | Type        | Null | Key | Default | Extra |
+----------------+-------------+------+-----+---------+-------+
| location_id    | int         | NO   | PRI | NULL    |       |
| street_address | varchar(25) | YES  |     | NULL    |       |
| postal_code    | varchar(12) | YES  |     | NULL    |       |
| city           | varchar(30) | YES  |     | NULL    |       |
| state_province | varchar(12) | YES  |     | NULL    |       |
| country_id     | char(2)     | YES  | MUL | NULL    |       |
+----------------+-------------+------+-----+---------+-------+
6 rows in set (0.00 sec)

mysql> desc department;
+-------------+-------------+------+-----+---------+-------+
| Field       | Type        | Null | Key | Default | Extra |
+-------------+-------------+------+-----+---------+-------+
| dept_id     | int         | NO   | PRI | NULL    |       |
| dept_name   | varchar(30) | YES  |     | NULL    |       |
| manager_id  | int         | YES  |     | NULL    |       |
| location_id | int         | YES  | MUL | NULL    |       |
+-------------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)

mysql> desc jobs;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| job_id     | varchar(10) | NO   | PRI | NULL    |       |
| job_title  | varchar(35) | YES  |     | NULL    |       |
| min_salary | int         | YES  |     | NULL    |       |
| max_salary | int         | YES  |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)

mysql> desc emaployee;
ERROR 1146 (42S02): Table 'revise.emaployee' doesn't exist
mysql> desc employee;
ERROR 1146 (42S02): Table 'revise.employee' doesn't exist
mysql> desc employees;
+---------------+-------------+------+-----+---------+-------+
| Field         | Type        | Null | Key | Default | Extra |
+---------------+-------------+------+-----+---------+-------+
| employee_id   | int         | NO   | PRI | NULL    |       |
| first_name    | varchar(20) | YES  |     | NULL    |       |
| last_name     | varchar(20) | YES  |     | NULL    |       |
| email         | varchar(25) | YES  |     | NULL    |       |
| phone_num     | varchar(20) | YES  |     | NULL    |       |
| hire_date     | date        | YES  |     | NULL    |       |
| job_id        | varchar(10) | YES  | MUL | NULL    |       |
| salary        | int         | YES  |     | NULL    |       |
| commision_pct | int         | YES  |     | NULL    |       |
| manager_id    | int         | YES  |     | NULL    |       |
| dept_id       | int         | YES  | MUL | NULL    |       |
+---------------+-------------+------+-----+---------+-------+
11 rows in set (0.00 sec)

mysql> desc job_history;
+-------------+-------------+------+-----+---------+-------+
| Field       | Type        | Null | Key | Default | Extra |
+-------------+-------------+------+-----+---------+-------+
| employee_id | int         | NO   | PRI | NULL    |       |
| start_date  | date        | NO   | PRI | NULL    |       |
| end_date    | date        | YES  |     | NULL    |       |
| job_id      | varchar(10) | YES  | MUL | NULL    |       |
| dept_id     | int         | YES  | MUL | NULL    |       |
+-------------+-------------+------+-----+---------+-------+
5 rows in set (0.00 sec)

mysql> desc job_grade;
+-------------+------------+------+-----+---------+-------+
| Field       | Type       | Null | Key | Default | Extra |
+-------------+------------+------+-----+---------+-------+
| grade_level | varchar(2) | NO   | PRI | NULL    |       |
| lowest_sal  | int        | YES  |     | NULL    |       |
| highest_sal | int        | YES  |     | NULL    |       |
+-------------+------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> insert into region values(1,America),(2,England);
ERROR 1054 (42S22): Unknown column 'America' in 'field list'
mysql> insert into region (region_id,region_name) values(1,America),(2,Engla
nd);
ERROR 1054 (42S22): Unknown column 'America' in 'field list'
mysql> insert into region (region_id,region_name) values(1,'America'),(2,'En
gland');
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> insert into countries values('US','United State',1),('UK','United Kingdom'2);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '2)' at line 1
mysql> insert into countries values('US','United State',1),('UK','United Kingdom',2);
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> insert into location values(1,'pqr','854','Scottsdale','AZ','US'),(2,
'abc','873','London','LE','UK');
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> insert into department values(1,'IT',100,200),(2,'HR',102,100);
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`revise`.`department`, CONSTRAINT `department_ibfk_1` FOREIGN KEY (`location_id`) REFERENCES `location` (`location_id`))
mysql> insert into department values(1,'IT',100,1),(2,'HR',102,2);
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> insert into jobs values('CEO','Developer',4000,10000),('MAN','HR Manager',3000,8000);
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> insert into employees values(1,'john','max','john@g.com','7494946','2002-10-15','CEO',7000,100,1,1);
Query OK, 1 row affected (0.01 sec)

mysql> insert into employees values(2,'smith','steve','smith@g.com','7494574
6','2005-07-15','MAN',7000,100,1,2);
Query OK, 1 row affected (0.00 sec)

mysql> insert into employees values(3,'bell','jame','bell@g.com','749763746'
,'2010-03-17','CEO',7000,100,1,1);
Query OK, 1 row affected (0.01 sec)

mysql> insert into employees values(4,'head','jam','head@g.com','949763746',
'2006-03-17','MAN',9000,100,1,2);
Query OK, 1 row affected (0.01 sec)

mysql> insert into job_grade values('A++',5000,8000);
ERROR 1406 (22001): Data too long for column 'grade_level' at row 1
mysql> insert into job_grade values('A+',5000,8000);
Query OK, 1 row affected (0.01 sec)

mysql> insert into job_grade values('B+',2000,9000);
Query OK, 1 row affected (0.01 sec)

mysql> select * from region;
+-----------+-------------+
| region_id | region_name |
+-----------+-------------+
|         1 | America     |
|         2 | England     |
+-----------+-------------+
2 rows in set (0.00 sec)

mysql> select * from countries;
+------------+----------------+-----------+
| country_id | country_name   | region_id |
+------------+----------------+-----------+
| UK         | United Kingdom |         2 |
| US         | United State   |         1 |
+------------+----------------+-----------+
2 rows in set (0.00 sec)

mysql> select * from location;
+-------------+----------------+-------------+------------+----------------+------------+
| location_id | street_address | postal_code | city       | state_province | country_id |
+-------------+----------------+-------------+------------+----------------+------------+
|           1 | pqr            | 854         | Scottsdale | AZ             | US         |
|           2 | abc            | 873         | London     | LE             | UK         |
+-------------+----------------+-------------+------------+----------------+------------+
2 rows in set (0.00 sec)

mysql> select * from department;
+---------+-----------+------------+-------------+
| dept_id | dept_name | manager_id | location_id |
+---------+-----------+------------+-------------+
|       1 | IT        |        100 |           1 |
|       2 | HR        |        102 |           2 |
+---------+-----------+------------+-------------+
2 rows in set (0.00 sec)

mysql> select * from job;
ERROR 1146 (42S02): Table 'revise.job' doesn't exist
mysql> select * from jobs;
+--------+------------+------------+------------+
| job_id | job_title  | min_salary | max_salary |
+--------+------------+------------+------------+
| CEO    | Developer  |       4000 |      10000 |
| MAN    | HR Manager |       3000 |       8000 |
+--------+------------+------------+------------+
2 rows in set (0.00 sec)

mysql> select * from employees;
+-------------+------------+-----------+-------------+-----------+------------+--------+--------+---------------+------------+---------+
| employee_id | first_name | last_name | email       | phone_num | hire_date  | job_id | salary | commision_pct | manager_id | dept_id |
+-------------+------------+-----------+-------------+-----------+------------+--------+--------+---------------+------------+---------+
|           1 | john       | max       | john@g.com  | 7494946   | 2002-10-15 | CEO    |   7000 |           100 |          1 |       1 |
|           2 | smith      | steve     | smith@g.com | 74945746  | 2005-07-15 | MAN    |   7000 |           100 |          1 |       2 |
|           3 | bell       | jame      | bell@g.com  | 749763746 | 2010-03-17 | CEO    |   7000 |           100 |          1 |       1 |
|           4 | head       | jam       | head@g.com  | 949763746 | 2006-03-17 | MAN    |   9000 |           100 |          1 |       2 |
+-------------+------------+-----------+-------------+-----------+------------+--------+--------+---------------+------------+---------+
4 rows in set (0.00 sec)

mysql> select * from job_grade;
+-------------+------------+-------------+
| grade_level | lowest_sal | highest_sal |
+-------------+------------+-------------+
| A+          |       5000 |        8000 |
| B+          |       2000 |        9000 |
+-------------+------------+-------------+
2 rows in set (0.00 sec)

mysql> select first_name,last_name,salary from employees where salary > (select avg(salary) from employees);
+------------+-----------+--------+
| first_name | last_name | salary |
+------------+-----------+--------+
| head       | jam       |   9000 |
+------------+-----------+--------+
1 row in set (0.01 sec)

mysql> select e.first_name,e.last_name,e.salary from employees e join job_grade jg on salary between jg.lowest_sal and jg.highest_sal where e.salary = jg.lowest_sal;
Empty set (0.01 sec)

mysql> select e.first_name,e.last_name,e.salary from employees e join department d on e.dept_id = d.dept_id where e.salary > (select avg(salary) from employees) and d.dept_name like '%IT%';
Empty set (0.01 sec)

mysql> select e1.first_name,e1.last_name,e1.salary from employees e1 where e1.salary > (select e2.salary from employees e2 where e2.first_name = 'Bell');
+------------+-----------+--------+
| first_name | last_name | salary |
+------------+-----------+--------+
| head       | jam       |   9000 |
+------------+-----------+--------+
1 row in set (0.00 sec)

mysql>