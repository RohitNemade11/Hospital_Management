

 desc Student;
+-------------+--------------+------+-----+---------+-------+
| Field       | Type         | Null | Key | Default | Extra |
+-------------+--------------+------+-----+---------+-------+
| studentId   | int          | NO   | PRI | NULL    |       |
| fullName    | varchar(100) | NO   |     | NULL    |       |
| email       | varchar(100) | NO   |     | NULL    |       |
| phoneNumber | varchar(15)  | NO   |     | NULL    |       |
+-------------+--------------+------+-----+---------+-------+
4 rows in set (0.05 sec)

mysql> create table Course (courceId int(20) primary key,courceName varchar(100) not null,durationMonths int(20) not null,fee decimal(10.2) not null);
Query OK, 0 rows affected, 2 warnings (0.03 sec)

mysql> desc Cource;
ERROR 1146 (42S02): Table 'exam.cource' doesn't exist
mysql> desc Course;
+----------------+---------------+------+-----+---------+-------+
| Field          | Type          | Null | Key | Default | Extra |
+----------------+---------------+------+-----+---------+-------+
| courceId       | int           | NO   | PRI | NULL    |       |
| courceName     | varchar(100)  | NO   |     | NULL    |       |
| durationMonths | int           | NO   |     | NULL    |       |
| fee            | decimal(10,0) | NO   |     | NULL    |       |
+----------------+---------------+------+-----+---------+-------+
4 rows in set (0.00 sec)

mysql> create table Batches (batchId int(20) primary key,courceId int(20),foreign key(courceId) references Cource(courceId),batchName varchar(50) not null,startDate date not null,endDate date not null);
ERROR 1824 (HY000): Failed to open the referenced table 'cource'
mysql> create table Batches (batchId int(20) primary key,courceId int(20),foreign key(courceId) references Cource(courceId),batchName varchar(50) not null,s
tartDate date not null,endDate date not null);
ERROR 1824 (HY000): Failed to open the referenced table 'cource'
mysql>
mysql>
mysql>
mysql>
mysql> create table Batches (batchId int(20) primary key,courceId int(20),foreign key(courceId) references Course(courceId),batchName varchar(50) not null,s
tartDate date not null,endDate date not null);
Query OK, 0 rows affected, 2 warnings (0.07 sec)

mysql> desc Batches;
+-----------+-------------+------+-----+---------+-------+
| Field     | Type        | Null | Key | Default | Extra |
+-----------+-------------+------+-----+---------+-------+
| batchId   | int         | NO   | PRI | NULL    |       |
| courceId  | int         | YES  | MUL | NULL    |       |
| batchName | varchar(50) | NO   |     | NULL    |       |
| startDate | date        | NO   |     | NULL    |       |
| endDate   | date        | NO   |     | NULL    |       |
+-----------+-------------+------+-----+---------+-------+
5 rows in set (0.01 sec)

mysql> create table Enrollments (enrollmentId int(20) primary key, studentId int(20),foreign key (studentId) references Student(studentId),batchId int(20),f
oreign key (batchId) references Batches(batchId),enollmentDate date not null);
Query OK, 0 rows affected, 3 warnings (0.06 sec)

mysql> insert into Student values ('1','Rohit Avinash Nemade','rohitnemade2024@gmail.com',9309108805);
Query OK, 1 row affected (0.02 sec)

mysql> insert into Student values ('101','Ram Suresh Thakare','ramthakare2025@gmail.com',8956235612);
Query OK, 1 row affected (0.01 sec)

mysql> insert into Student values ('102','Sham Suresh Thakare','shamthakare2025@gmail.com',8955555612);
Query OK, 1 row affected (0.01 sec)

mysql> insert into Student values ('103','Raj Suresh Thakare','rajthakare2025@gmail.com',3355555612);
Query OK, 1 row affected (0.01 sec)

mysql> insert into Student values ('104','Harish Keshav Nagose','harishnogose2025@gmail.com',3355555223);
Query OK, 1 row affected (0.01 sec)

mysql> insert into Student values ('105','pankaj Keshav Nagose','pankajnogose2025@gmail.com',4444444);
Query OK, 1 row affected (0.01 sec)

mysql> insert into Student values ('106','Pavan Keshav Nagose','pavannogose2025@gmail.com',3333344555);
Query OK, 1 row affected (0.01 sec)

mysql> insert into Student values ('107','Rushi Sunil Ponde','rushiponde2025@gmail.com',366448899);
Query OK, 1 row affected (0.01 sec)

mysql> select * from Student;
+-----------+----------------------+----------------------------+-------------+
| studentId | fullName             | email                      | phoneNumber |
+-----------+----------------------+----------------------------+-------------+
|         1 | Rohit Avinash Nemade | rohitnemade2024@gmail.com  | 9309108805  |
|       101 | Ram Suresh Thakare   | ramthakare2025@gmail.com   | 8956235612  |
|       102 | Sham Suresh Thakare  | shamthakare2025@gmail.com  | 8955555612  |
|       103 | Raj Suresh Thakare   | rajthakare2025@gmail.com   | 3355555612  |
|       104 | Harish Keshav Nagose | harishnogose2025@gmail.com | 3355555223  |
|       105 | pankaj Keshav Nagose | pankajnogose2025@gmail.com | 4444444     |
|       106 | Pavan Keshav Nagose  | pavannogose2025@gmail.com  | 3333344555  |
|       107 | Rushi Sunil Ponde    | rushiponde2025@gmail.com   | 366448899   |
+-----------+----------------------+----------------------------+-------------+
8 rows in set (0.00 sec)

mysql> ^C
mysql> INSERT INTO Course VALUES
    -> (1, 'Data Science', 6, 50000),
    -> (2, 'Web Development', 4, 30000),
    -> (3, 'AI and ML', 8, 70000),
    -> (4, 'Cybersecurity', 6, 55000),
    -> (5, 'Cloud Computing', 5, 40000),
    -> (6, 'DevOps', 4, 35000),
    -> (7, 'Digital Marketing', 3, 20000),
    -> (8, 'Blockchain', 6, 60000),
    -> (9, 'UI/UX Design', 4, 25000),
    -> (10, 'Big Data Analytics', 8, 80000)
    ->
    -> ^C
mysql> INSERT INTO Course VALUES
    -> (1, 'Data Science', 6, 50000),
    -> (2, 'Web Development', 4, 30000),
    -> (3, 'AI and ML', 8, 70000),
    -> (4, 'Cybersecurity', 6, 55000),
    -> (5, 'Cloud Computing', 5, 40000),
    -> (6, 'DevOps', 4, 35000),
    -> (7, 'Digital Marketing', 3, 20000),
    -> (8, 'Blockchain', 6, 60000),
    -> (9, 'UI/UX Design', 4, 25000),
    -> (10, 'Big Data Analytics', 8, 80000);
Query OK, 10 rows affected (0.01 sec)
Records: 10  Duplicates: 0  Warnings: 0

mysql>
mysql> select * from  Course ;
+----------+--------------------+----------------+-------+
| courceId | courceName         | durationMonths | fee   |
+----------+--------------------+----------------+-------+
|        1 | Data Science       |              6 | 50000 |
|        2 | Web Development    |              4 | 30000 |
|        3 | AI and ML          |              8 | 70000 |
|        4 | Cybersecurity      |              6 | 55000 |
|        5 | Cloud Computing    |              5 | 40000 |
|        6 | DevOps             |              4 | 35000 |
|        7 | Digital Marketing  |              3 | 20000 |
|        8 | Blockchain         |              6 | 60000 |
|        9 | UI/UX Design       |              4 | 25000 |
|       10 | Big Data Analytics |              8 | 80000 |
+----------+--------------------+----------------+-------+
10 rows in set (0.01 sec)

mysql> insert into Batches VALUES
    -> (1, 1, 'Batch A', '2025-01-01', '2025-06-30'),
    -> (2, 2, 'Batch B', '2025-02-01', '2025-05-31'),
    -> (3, 3, 'Batch C', '2025-03-01', '2025-10-31'),
    -> (4, 4, 'Batch D', '2025-01-15', '2025-06-15'),
    -> (5, 5, 'Batch E', '2025-02-15', '2025-07-15'),
    -> (6, 6, 'Batch F', '2025-03-15', '2025-07-15'),
    -> (7, 7, 'Batch G', '2025-04-01', '2025-06-30'),
    -> (8, 8, 'Batch H', '2025-05-01', '2025-10-31'),
    -> (9, 9, 'Batch I', '2025-06-01', '2025-09-30'),
    -> (10, 10, 'Batch J', '2025-07-01', '2026-02-29');
ERROR 1292 (22007): Incorrect date value: '2026-02-29' for column 'endDate' at row 10
mysql> insert into Batches VALUES
    -> (1, 1, 'Batch A', '2025-01-01', '2025-06-30'),
    -> (2, 2, 'Batch B', '2025-02-01', '2025-05-31'),
    -> (3, 3, 'Batch C', '2025-03-01', '2025-10-31'),
    -> (4, 4, 'Batch D', '2025-01-15', '2025-06-15'),
    -> (5, 5, 'Batch E', '2025-02-15', '2025-07-15'),
    -> (6, 6, 'Batch F', '2025-03-15', '2025-07-15'),
    -> (7, 7, 'Batch G', '2025-04-01', '2025-06-30'),
    -> (8, 8, 'Batch H', '2025-05-01', '2025-10-31'),
    -> (9, 9, 'Batch I', '2025-06-01', '2025-09-30'),
    -> (10, 10, 'Batch J', '2025-07-01', '2026-02-29');
ERROR 1292 (22007): Incorrect date value: '2026-02-29' for column 'endDate' at row 10
mysql> insert into Batches VALUES
    -> (1, 1, 'Batch A', '2025-01-01', '2025-06-30'),
    -> (2, 2, 'Batch B', '2025-02-01', '2025-05-31'),
    -> (3, 3, 'Batch C', '2025-03-01', '2025-10-31'),
    -> (4, 4, 'Batch D', '2025-01-15', '2025-06-15'),
    -> (5, 5, 'Batch E', '2025-02-15', '2025-07-15'),
    -> (6, 6, 'Batch F', '2025-03-15', '2025-07-15'),
    -> (7, 7, 'Batch G', '2025-04-01', '2025-06-30'),
    -> (8, 8, 'Batch H', '2025-05-01', '2025-10-31'),
    -> (9, 9, 'Batch I', '2025-06-01', '2025-09-30'),
    -> (10, 10, 'Batch J', '2025-07-01', '2026-02-27');
Query OK, 10 rows affected (0.01 sec)
Records: 10  Duplicates: 0  Warnings: 0

mysql> select * from Batches;
+---------+----------+-----------+------------+------------+
| batchId | courceId | batchName | startDate  | endDate    |
+---------+----------+-----------+------------+------------+
|       1 |        1 | Batch A   | 2025-01-01 | 2025-06-30 |
|       2 |        2 | Batch B   | 2025-02-01 | 2025-05-31 |
|       3 |        3 | Batch C   | 2025-03-01 | 2025-10-31 |
|       4 |        4 | Batch D   | 2025-01-15 | 2025-06-15 |
|       5 |        5 | Batch E   | 2025-02-15 | 2025-07-15 |
|       6 |        6 | Batch F   | 2025-03-15 | 2025-07-15 |
|       7 |        7 | Batch G   | 2025-04-01 | 2025-06-30 |
|       8 |        8 | Batch H   | 2025-05-01 | 2025-10-31 |
|       9 |        9 | Batch I   | 2025-06-01 | 2025-09-30 |
|      10 |       10 | Batch J   | 2025-07-01 | 2026-02-27 |
+---------+----------+-----------+------------+------------+
10 rows in set (0.00 sec)

mysql> insert into  Enrollments values
    -> (1, 1, 1, '2025-01-01'),
    -> (2, 101, 2, '2025-02-01'),
    -> (3, 102, 3, '2025-03-01'),
    -> (4, 103, 4, '2025-01-15'),
    -> (5, 104, 5, '2025-02-15'),
    -> (6, 105, 6, '2025-03-15'),
    -> (7, 106, 7, '2025-04-01'),
    -> (8, 107, 8, '2025-05-01'),
    -> (9, 101, 9, '2025-06-01'),
    -> (10, 102, 10, '2025-07-01');
Query OK, 10 rows affected (0.01 sec)
Records: 10  Duplicates: 0  Warnings: 0

mysql> select * from Enrollments;
+--------------+-----------+---------+---------------+
| enrollmentId | studentId | batchId | enollmentDate |
+--------------+-----------+---------+---------------+
|            1 |         1 |       1 | 2025-01-01    |
|            2 |       101 |       2 | 2025-02-01    |
|            3 |       102 |       3 | 2025-03-01    |
|            4 |       103 |       4 | 2025-01-15    |
|            5 |       104 |       5 | 2025-02-15    |
|            6 |       105 |       6 | 2025-03-15    |
|            7 |       106 |       7 | 2025-04-01    |
|            8 |       107 |       8 | 2025-05-01    |
|            9 |       101 |       9 | 2025-06-01    |
|           10 |       102 |      10 | 2025-07-01    |
+--------------+-----------+---------+---------------+
10 rows in set (0.00 sec)







1)   mysql> select courceName from Course where fee between 20000 and 60000;
+-------------------+
| courceName        |
+-------------------+
| Data Science      |
| Web Development   |
| Cybersecurity     |
| Cloud Computing   |
| DevOps            |
| Digital Marketing |
| Blockchain        |
| UI/UX Design      |
+-------------------+
8 rows in set (0.00 sec)

mysql>


2)find the student who enrolled in more than one batch .
mysql> select  studentId from Enrollments group by studentId having count(batchId) > 1;
+-----------+
| studentId |
+-----------+
|       101 |
|       102 |
+-----------+
2 rows in set (0.01 sec)


3)list all batches with the number of student enrolled in each batch

mysql> select Batches.batchId, Batches.batchName, count(Enrollments.studentId) AS studentCount from Batches left join Enrollments on Batches.batchId = Enrollments.batchId group by Batches.batchId, Batches.batchName;
+---------+-----------+--------------+
| batchId | batchName | studentCount |
+---------+-----------+--------------+
|       1 | Batch A   |            1 |
|       2 | Batch B   |            1 |
|       3 | Batch C   |            1 |
|       4 | Batch D   |            1 |
|       5 | Batch E   |            1 |
|       6 | Batch F   |            1 |
|       7 | Batch G   |            1 |
|       8 | Batch H   |            1 |
|       9 | Batch I   |            1 |
|      10 | Batch J   |            1 |
+---------+-----------+--------------+
10 rows in set (0.01 sec

4)find the student who have not enrolled any batch.

mysql>
mysql> select Student.studentId, Student.fullName from Student left join Enrollments on Student.studentId = Enrollments.studentId where  Enrollments.batchId is null;
Empty set (0.01 sec)




5)Retrive the total fee collected for each course based on enrollments.


 select Course.courceName, sum(Course.fee) AS totalFeeCollected from Course join Batches on Course.courceId = Batches.courceId join Enrollments on Batches.batchId = Enrollments.batchId group by Course.courceName;
+--------------------+-------------------+
| courceName         | totalFeeCollected |
+--------------------+-------------------+
| Data Science       |             50000 |
| Web Development    |             30000 |
| AI and ML          |             70000 |
| Cybersecurity      |             55000 |
| Cloud Computing    |             40000 |
| DevOps             |             35000 |
| Digital Marketing  |             20000 |
| Blockchain         |             60000 |
| UI/UX Design       |             25000 |
| Big Data Analytics |             80000 |
+--------------------+-------------------+
10 rows in set (0.00 sec)


6)list All students along with the batch name and cource name they are enrolled in.

 select Student.studentId, Student.fullName, Batches.batchName, Course.courceName from Student join Enrollments on Student.studentId = Enrollments.studentId join Batches on Enrollments.batchId = Batches.batchId join Course ON Batches.courceId = Course.courceId;
+-----------+----------------------+-----------+--------------------+
| studentId | fullName             | batchName | courceName         |
+-----------+----------------------+-----------+--------------------+
|         1 | Rohit Avinash Nemade | Batch A   | Data Science       |
|       101 | Ram Suresh Thakare   | Batch B   | Web Development    |
|       101 | Ram Suresh Thakare   | Batch I   | UI/UX Design       |
|       102 | Sham Suresh Thakare  | Batch C   | AI and ML          |
|       102 | Sham Suresh Thakare  | Batch J   | Big Data Analytics |
|       103 | Raj Suresh Thakare   | Batch D   | Cybersecurity      |
|       104 | Harish Keshav Nagose | Batch E   | Cloud Computing    |
|       105 | pankaj Keshav Nagose | Batch F   | DevOps             |
|       106 | Pavan Keshav Nagose  | Batch G   | Digital Marketing  |
|       107 | Rushi Sunil Ponde    | Batch H   | Blockchain         |
+-----------+----------------------+-----------+--------------------+
10 rows in set (0.00 sec)


7)find all students enrolled in a specific cource;



select Student.studentId, Student.fullName from Student join Enrollments on Student.studentId = Enrollments.studentId join Batches ON Enrollments.batchId = Batches.batchId Join Course on Batches.courceId = Course.courceId where Course.courceName = 'Data Science';
+-----------+----------------------+
| studentId | fullName             |
+-----------+----------------------+
|         1 | Rohit Avinash Nemade |
+-----------+----------------------+
1 row in set (0.00 sec)


8)find the students who enrolled in the same batch as a specific student(e.g.studentId=101).


mysql> select DISTINCT s.studentId, s.fullName from Enrollments e1 join Enrollments e2 ON e1.batchId = e2.batchId join Student s ON e2.studentId = s.studentId where e1.studentId = 101 and e2.studentId != 101;
Empty set (0.01 sec)

mysql>

9)find the total number of enrollments for each course.


 select c.courceId, c.courceName, COUNT(e.enrollmentId) AS totalEnrollments from Course c join Batches b ON c.courceId = b.courceId join Enrollments e ON b.batchId = e.batchId group by c.courceId, c.courceName;
+----------+--------------------+------------------+
| courceId | courceName         | totalEnrollments |
+----------+--------------------+------------------+
|        1 | Data Science       |                1 |
|        2 | Web Development    |                1 |
|        3 | AI and ML          |                1 |
|        4 | Cybersecurity      |                1 |
|        5 | Cloud Computing    |                1 |
|        6 | DevOps             |                1 |
|        7 | Digital Marketing  |                1 |
|        8 | Blockchain         |                1 |
|        9 | UI/UX Design       |                1 |
|       10 | Big Data Analytics |                1 |
+----------+--------------------+------------------+
10 rows in set (0.00 sec)

mysql>




10)retive the total number of students and tha average fee collected per batch.

elect b.batchId, b.batchName, count(e.studentId) AS totalStudents, avg(c.fee) AS avgFeeCollected from Batches b join Enrollments e ON b.batchId = e.batchId   join Course c ON b.courceId = c.courceId group by b.batchId, b.batchName;
+---------+-----------+---------------+-----------------+
| batchId | batchName | totalStudents | avgFeeCollected |
+---------+-----------+---------------+-----------------+
|       1 | Batch A   |             1 |      50000.0000 |
|       2 | Batch B   |             1 |      30000.0000 |
|       3 | Batch C   |             1 |      70000.0000 |
|       4 | Batch D   |             1 |      55000.0000 |
|       5 | Batch E   |             1 |      40000.0000 |
|       6 | Batch F   |             1 |      35000.0000 |
|       7 | Batch G   |             1 |      20000.0000 |
|       8 | Batch H   |             1 |      60000.0000 |
|       9 | Batch I   |             1 |      25000.0000 |
|      10 | Batch J   |             1 |      80000.0000 |
+---------+-----------+---------------+-----------------+
10 rows in set (0.01 sec)





11)write a Sql function to calculate the factorial of a number .






12)write a sql function to calculate the power of a number using a loop.






15)write a trigger that updates the fee in all related batches when the fee in the courses table is updated.


17)create a view that lists all students along with theire enrolled cource name and batch name


> create  view StudentEnrollments AS
    -> select
    ->     s.studentId,
    ->     s.fullName,
    ->     s.email,
    ->     s.phoneNumber,
    ->     c.courceName,
    ->     b.batchName
    -> from
    ->     Enrollments e
    -> join
    ->     Student s on e.studentId = s.studentId
    -> join
    ->     Batches b on e.batchId = b.batchId
    -> join
    ->     Course c on b.courceId = c.courceId;
Query OK, 0 rows affected (0.02 sec) 
